<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Shopping Cart</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="container mt-5">
    <h2>Your Cart</h2>
    <div id="cart-content"></div>
    <script>
      function renderCart() {
        let cart = JSON.parse(localStorage.getItem('cart') || '[]');
        let html = '';
        if (cart.length === 0) {
          html = '<p>Your cart is empty.</p>';
        } else {
          let total = 0;
          html += '<table class="table table-bordered"><thead><tr><th>Product</th><th>Price</th><th>Quantity</th><th>Subtotal</th><th>Action</th></tr></thead><tbody>';
          cart.forEach((item, idx) => {
            total += item.price * item.qty;
            html += `<tr>
              <td>${item.name}</td>
              <td>$${item.price}</td>
              <td><input type='number' min='1' value='${item.qty}' style='width:60px' onchange='updateQty(${item.id}, this.value)'></td>
              <td>$${(item.price * item.qty).toFixed(2)}</td>
              <td><button class='btn btn-danger btn-sm' onclick='removeFromCart(${item.id})'>Remove</button></td>
            </tr>`;
          });
          html += `</tbody></table><h4>Total: $${total.toFixed(2)}</h4><a href="/checkout" class="btn btn-success">Proceed to Checkout</a>`;
        }
        document.getElementById('cart-content').innerHTML = html;
      }
      function updateQty(id, qty) {
        let cart = JSON.parse(localStorage.getItem('cart') || '[]');
        qty = parseInt(qty);
        cart = cart.map(item => item.id === id ? { ...item, qty: qty > 0 ? qty : 1 } : item);
        localStorage.setItem('cart', JSON.stringify(cart));
        renderCart();
      }
      function removeFromCart(id) {
        let cart = JSON.parse(localStorage.getItem('cart') || '[]');
        cart = cart.filter(item => item.id !== id);
        localStorage.setItem('cart', JSON.stringify(cart));
        renderCart();
      }
      document.addEventListener('DOMContentLoaded', renderCart);
    </script>
  </div>
</body>
</html>
